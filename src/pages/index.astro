---
import Layout from "../layouts/Layout.astro";
import Seo from "../components/seo.astro";
import Spacer from "../components/Spacer.astro";
import PageWrapper from "../components/layouts/PageWrapper.astro";
import ContactSection from "../components/layouts/ContactSection.astro";
import { getCollection } from "astro:content";
import fs from "fs";

// gather SVG logos from public/images/logos at build time
type LogoEntry = { name: string; svg: string };
let logoSvgs: LogoEntry[] = [];
try {
	const logosDir = new URL("../../public/images/logos/", import.meta.url);
	const items = fs.readdirSync(logosDir, { withFileTypes: true });
	logoSvgs = items
		.filter((d) => d.isFile() && d.name.toLowerCase().endsWith(".svg"))
		.map((d) => {
			const fileUrl = new URL(d.name, logosDir);
			const svg = fs.readFileSync(fileUrl, "utf8");
			return { name: d.name, svg };
		});
} catch (err) {
	logoSvgs = [];
}

const logosHtml = logoSvgs
	.map((l) => `<div class="logo-item fadeup-st">${l.svg}</div>`)
	.join("");

//gathering cases for work section
const modules = import.meta.glob("../content/cases/*.md", {
	eager: true,
}) as Record<string, any>;

const moduleKeys = Object.keys(modules || {});

const posts = moduleKeys
	.map((path) => {
		const mod = (modules as Record<string, any>)[path];
		const fm = (mod as any).frontmatter || {};
		const filename = path.match(/([^/\\]+)\.md$/)?.[1] || "";
		const slug = fm.slug || filename;
		return {
			...fm,
			url: `/cases/${slug}`,
			__path: path,
		};
	})
	.sort(
		(a, b) =>
			(Date.parse(b.date || "") || 0) - (Date.parse(a.date || "") || 0),
	);

// Fetch recent blog posts for featured section
const allBlogPosts = (await getCollection("blog"))
	.filter((post) => import.meta.env.DEV || !post.data.draft)
	.sort((a, b) => new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime());

// Get the 2 most recent posts
const featuredPosts = allBlogPosts.slice(0, 2);

// Format date helper
const formatDate = (date: string) =>
	new Date(date).toLocaleDateString("en-US", {
		month: "short",
		day: "2-digit",
		year: "numeric",
	});
---

<script>
	import "@mux/mux-player";
</script>

<Layout title="Daniel Fridgren">
	<Seo
		title="Daniel Fridgren — Senior UX Design for product leaders"
		description="Helping organisations build complex products with simple user flows, from discovery to final implementation."
		pathname={Astro.url.pathname}
		keywords={[
			"user experience",
			"ux design",
			"ui design",
			"digital strategy",
			"product design",
			"digital transformation",
			"digital consulting",
			"customer experience",
			"daniel fridgren",
		]}
	/>
	
	<!-- Video Structured Data for Search Engines -->
	<script type="application/ld+json" set:html={JSON.stringify({
		"@context": "https://schema.org",
		"@type": "VideoObject",
		"name": "Daniel Fridgren - UX Design Portfolio Showcase",
		"description": "Senior UX Designer helping organizations build complex products with simple user flows",
		"thumbnailUrl": `${Astro.site}images/og-image.png`,
		"uploadDate": "2025-12-03T16:24:14Z",
		"duration": "PT33S",
		"contentUrl": "https://stream.mux.com/heEyyMTCGulT0201qoOrDX4sj4mi6Kvw7Kc8ryw7MbviY.m3u8",
		"embedUrl": "https://youtu.be/N9Z1nwKOgv8",
		"publisher": {
			"@type": "Person",
			"name": "Daniel Fridgren",
			"url": Astro.site
		}
	})} />

	<PageWrapper>
			<section id="hero" class="section-hero full-bleed">
				<mux-player
					playback-id="heEyyMTCGulT0201qoOrDX4sj4mi6Kvw7Kc8ryw7MbviY"
					accent-color="#e6a92c"
					thumbnail-time="2"
					loop="true"
					autoplay="any"></mux-player>
				<Spacer size="large" />
			</section>

			<section id="about" class="section">
				<div class="grid-columns-2">
					<p class="title-section fadeup-st">About</p>
					<div class="prose">
						<h1 class="fadeup-st">
							Senior UX Design for product leaders who need a
							strong partner
						</h1>
						<br />
						<div class="text fadeup-st">
							I'm Daniel Fridgren, a senior UX designer currently working at <a
								href="https://wisecompany.se">In Wise Company</a
							>, where I help organizations build complex products
							with simple user flows, all the way from early
							discovery to final implementation.
							<Spacer size="xs" />
							With 20 years of hands-on experience across established
							product companies and fast-moving agencies, I bring structure,
							direction, and design that holds up in the real world.
							<Spacer size="xs" />
							My approach blends strategic insight with practical delivery:
							understand what matters, prioritize effectively, deliver
							quickly, and create solutions that stand the test of
							time.
							<Spacer size="xs" />
							Want to discuss a project or explore working together?
						</div>
						<Spacer size="small" />
						<a
							href="mailto:daniel@fridgren.se?subject=Meeting+request"
							class="button fadeup-st"
							data-umami-event="Top CTA Click"
							target="_blank"
							rel="noreferrer">Book a meeting</a
						>
					</div>
				</div>
			</section>
			<Spacer size="xl" />
			<section id="services" class="section">
				<div class="grid-columns-2">
					<p class="title-section fadeup-st">Services</p>
					<div class="prose">
						<h1 class="fadeup-st">
							Supporting product teams with clarity and direction
						</h1>
						<Spacer size="small" />
						<ul class="list-styled fadeup-st">
							<li class="">
								<img
									src="/images/icon-product-design.svg"
									alt="Product design icon"
									width="28"
									height="28"
								/>
								<div class="service-item">
									<p class="heading-sub-lg">
										Product design
									</p>
									<p
											class="text"
										style="margin: 0; margin-top: 0.25rem;"
									>
										From early discovery to final interface
										— translating insights, constraints and
										business goals into products that work.
									</p>
								</div>
							</li>
							<li class="">
								<img
									src="/images/icon-user-research.svg"
									alt="User research icon"
									width="28"
									height="28"
								/>
								<div class="service-item">
									<p class="heading-sub-lg">User research</p>
									<p
										class="text"
										style="margin: 0; margin-top: 0.25rem;"
									>
										Planning and conducting research to
										uncover needs, reduce uncertainty and
										inform product decisions with evidence.
									</p>
								</div>
							</li>
							<li class="">
								<img
									src="/images/icon-prototyping.svg"
									alt="Prototyping icon"
									width="28"
									height="28"
								/>
								<div class="service-item">
									<p class="heading-sub-lg">
										Prototyping & validation
									</p>
									<p
										class="text"
										style="margin: 0; margin-top: 0.25rem;"
									>
										Building interactive prototypes to
										explore concepts, validate assumptions
										and improve usability before investing
										in development.
									</p>
								</div>
							</li>
							<li class="">
								<img
									src="/images/icon-strategy.svg"
									alt="Strategy icon"
									width="28"
									height="28"
								/>
								<div class="service-item">
									<p class="heading-sub-lg">
										Design strategy
									</p>
									<p
										class="text"
										style="margin: 0; margin-top: 0.25rem;"
									>
										Clarifying product direction by aligning
										user needs, business priorities, and
										technical realities.
									</p>
								</div>
							</li>
							<li class="">
								<img
									src="/images/icon-teambuilding.svg"
									alt="Building teams icon"
									width="28"
									height="28"
								/>
								<div class="service-item">
									<p class="heading-sub-lg">
										Design team enablement
									</p>

									<p
										class="text"
										style="margin: 0; margin-top: 0.25rem;"
									>
										Helping organisations grow confident,
										autonomous design teams through
										coaching, hiring support and practical
										ways of working.
									</p>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</section>
			<Spacer size="xl" />
			<section id="work" class="section">
				<div class="service-item">
					<h1 class="fadeup-st">Selected case studies</h1>
					<div class="text fadeup-st">
						A curated mix of UX, discovery and research work from
						recent engagements.
					</div>
					<Spacer size="small" />
					<div class="portfolio">
						{
							posts.map((p) => (
								<a
									class="portfolio-item link-unstyled fadeup-st"
									href={p.url}
									aria-label={`Open case study about ${p.title || p.__path}`}
								>
									{p.heroImage || p.image ? (
										<figure class="portfolio-figure">
											<img
												src={
													p.heroImage ||
													p.image ||
													"/images/og-image.png"
												}
												alt={p.title || ""}
												loading="lazy"
											/>
										</figure>
									) : null}

									<div class="portfolio-card-header">
										<div class="portfolio-card-title">
											{p.description || p.excerpt || ""}
										</div>
										<h3 class="portfolio-card-subtitle">
											{p.client || p.__path}
										</h3>
									</div>
								</a>
								<Spacer size="xs" />
							))
						}
					</div>

					{
						posts.length === 0 ? (
								<div class="text">
								<p>
									No case posts found. Diagnostic info
									(development only):
								</p>
								<pre style="white-space:pre-wrap; background:#f6f6f6; padding:8px; border-radius:4px;">
									{JSON.stringify(
										Object.keys(modules || {}),
										null,
										2,
									)}
								</pre>
							</div>
						) : null
					}
				</div>
			</section>
			<!--<Spacer size="xl" />
			
				<section id="blog-featured" class="section">
					
						<div></div>
						<div class="prose">
						<h1 class="fadeup-st">Latest from the blog</h1>
						<div class="text fadeup-st">
							Recent thoughts on design, complexity and technology.
						</div>
						<Spacer size="small" />
						<div class="blog-cards prose">
							{featuredPosts.map((post) => (
								<a
									href={`/blog/${post.slug}`}
									class="blog-card fadeup-st"
								>
									<div class="blog-card-content">
										<time class="blog-card-date" datetime={post.data.pubDate}>
											{formatDate(post.data.pubDate)}
										</time>
										<h3 class="service-item">{post.data.title}</h3>
										{post.data.description && (
											<p class="blog-card-description">
												{post.data.description}
											</p>
										)}
										<span class="blog-card-link" data-umami-event="Blog Read Article">Read article →</span>
									</div>
								</a>
							))}
						</div>	
				</div>
			</section>
			<Spacer size="large" />
 
-->
 <ContactSection />
			<a
				href="https://www.brainville.com/SE/Brainville1"
				target="_blank"
				rel="noopener noreferrer"
				style="position:absolute; left:-9999px;"
			>
				<img
					src="https://www.brainville.com/Content/Images/SocialMedia/OnLight_Flat.svg"
					alt="Check out our company profile in Brainville"
				/>
			</a>
		</PageWrapper>
</Layout>

<style>
	/* Full bleed hero section */
	.section-hero.full-bleed {
		width: 100vw;
		max-width: 1600px;
		margin-left: 50%;
		transform: translateX(-50%);
		margin-top: 0;
		margin-bottom: var(--space-xl);
	}

	.section-hero.full-bleed mux-player {
		width: 100%;
		height: auto;
	}

	@media (max-width: 768px) {
		.section-hero.full-bleed {
			margin-top: calc(-1 * var(--space-s));
		}
	}

	@media (max-width: 1600px) {
		.section-hero.full-bleed {
			width: 100vw;
		}
	}


	/* Logo grid for Employers & Clients */
	.logo-grid {
		display: grid;
		grid-template-columns: repeat(3, 1fr);
		gap: 3rem;
		align-items: center;
		justify-items: left;
	}

	.logo-item img,
	.logo-item svg {
		max-width: 160px;
		width: 100%;
		height: auto;
		display: block;
		object-fit: contain;
	}

	@media (max-width: 640px) {
		.logo-grid {
			grid-template-columns: repeat(2, 1fr);
			gap: 2.5rem;
		}
		.logo-item img,
		.logo-item svg {
			max-width: 120px;
		}
	}

	/* Service text highlight effect */
	.service-item p {
		color: var(--color-subtle);
		transition: color 0.25s ease;
	}

	.service-item .body-text {
		max-width: 42ch;
	}

	.service-item.in-focus p {
		color: var(--color-fg);
	}

	/* Work cards stacked layout */

	.blog-cards {
		display: flex;
		flex-direction: column;
		gap: var(--space-l);
		margin-top: var(--space-l);
	}

	.blog-card {
		display: flex;
		flex-direction: column;
		padding: var(--space-xl);
		border: 1px solid var(--color-very-subtle);
		text-decoration: none;
		background: white;
	}

	.blog-card:hover {
		border-color: var(--color-subtle);
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
	}

	.blog-card-content {
		display: flex;
		flex-direction: column;
		gap: var(--space-xs);
		height: 100%;
	}

	.blog-card-date {
		font-size: var(--fs-xs);
		color: var(--color-muted);
		font-weight: 500;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}


	.blog-card-description {
		font-size: var(--fs-base);
		line-height: var(--leading-base);
		color: var(--color-muted);
		margin: 0;
		margin-top: var(--space-m);
		flex-grow: 1;
	}

	.blog-card-link {
		font-size: var(--fs-base);
		color: var(--color-yellow);
		font-weight: 500;
		margin-top: var(--space-xs);
		text-decoration: none;
	}

	.blog-card:hover .blog-card-link {
		text-decoration: underline;
	}

	@media (max-width: 768px) {
		.blog-cards {
			gap: var(--space-m);
		}

		.blog-card {
			padding: var(--space-l);
		}
	}

	.portfolio-card-stacked {
		display: flex;
		flex-direction: column;
		gap: var(--space-m);
	}


	.portfolio-card-stacked:hover {
		color: var(--color-muted);
	}

	.portfolio-card-stacked .portfolio-figure {
		margin: 0;
		overflow: hidden;
		border-radius: var(--border-radius-base);
	}

	.portfolio-card-stacked .portfolio-figure img {
		width: 100%;
		height: auto;
		display: block;
		transition:
			transform 240ms ease,
			opacity 240ms ease;
	}

	.portfolio-card-stacked:hover .portfolio-figure img {
		transform: scale(1.02);
		opacity: 0.95;
	}

	.portfolio-card-description {
		font-family: var(--font-body);
		font-size: var(--fs-md);
		line-height: var(--leading-base);
		color: var(--color-muted);
		max-width: 60ch;
		margin: 0;
	}

	@media (max-width: 768px) {
		.portfolio-card-description {
			font-size: var(--fs-base);
		}
	}
</style>

<script>
	// fallback: if mux-player fails to load, replace with image
	const player = document.getElementById("baxter-player");
	if (player) {
		player.addEventListener("error", () => {
			const figure = player.closest(".portfolio-figure");
			if (figure) {
				figure.innerHTML =
					'<img src="/images/baxter.png" alt="Baxter dialysis user interface" loading="lazy" />';
			}
		});
	}
</script>

<script>
	// Service text highlight effect when in middle 10% of screen
	const serviceItems = document.querySelectorAll(
		".service-item",
	) as NodeListOf<HTMLElement>;
	if (serviceItems.length > 0) {
		let ticking = false;

		const updateHighlight = () => {
			const viewportHeight = window.innerHeight;
			const targetY = viewportHeight * 0.5; // Center of viewport

			let closestItem: HTMLElement | null = null;
			let closestDistance = Infinity;

			// Find the item closest to the center
			serviceItems.forEach((item) => {
				const rect = item.getBoundingClientRect();
				const itemCenter = rect.top + rect.height / 2;
				const distance = Math.abs(itemCenter - targetY);

				if (distance < closestDistance) {
					closestDistance = distance;
					closestItem = item;
				}
			});

			// Only highlight the closest item
			serviceItems.forEach((item) => {
				if (item === closestItem) {
					item.classList.add("in-focus");
				} else {
					item.classList.remove("in-focus");
				}
			});

			ticking = false;
		};

		window.addEventListener(
			"scroll",
			() => {
				if (!ticking) {
					requestAnimationFrame(updateHighlight);
					ticking = true;
				}
			},
			{ passive: true },
		);

		// Initial call
		updateHighlight();
	}
</script>
