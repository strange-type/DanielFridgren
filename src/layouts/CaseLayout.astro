---
import Layout from "./Layout.astro";
import Spacer from "../components/Spacer.astro";
import PageWrapper from "../components/layouts/PageWrapper.astro";
import ContactSection from "../components/layouts/ContactSection.astro";
import SEO from "../components/seo.astro";
const { frontmatter } = Astro.props;

const title = frontmatter.title || "Case";
const description = frontmatter.description || "";
const seoKeywords: string[] = (frontmatter.seoKeywords as string[]) ?? [];
const pathname = Astro.url.pathname;
const ogImage =
  frontmatter.ogImage || frontmatter.heroImage || "/images/og-image.png";
const secondaryImage = frontmatter.secondaryImage || "";
const client = frontmatter.client || "";
const dateRaw = frontmatter.date || "";
let formattedDate = "";
try {
  formattedDate = dateRaw
    ? new Date(dateRaw).toLocaleDateString("sv-SE", {
        year: "numeric",
        month: "long",
        day: "numeric",
      })
    : "";
} catch (e) {
  formattedDate = dateRaw;
}
const tags: string[] = (frontmatter.tags as string[]) ?? [];
const playbackId = frontmatter.playbackId as string | undefined;
---

<script>
  import "@mux/mux-player";
</script>

<Layout>
  <SEO
    title={title}
    description={description}
    keywords={seoKeywords}
    pathname={pathname}
  />

  <main>
    <PageWrapper>
      <section class="section-hero">
        <Spacer />
        <div>
          <h1 class="title-page prose fadeup-st">{title}</h1>
          <div class="title-section fadeup-st">
            {client}
          </div>
        </div>
      </section>
      {
        playbackId ? (
          <mux-player
            id={`${frontmatter.slug || "case"}-player`}
            playback-id={playbackId}
            accent-color={frontmatter.playbackAccent || "#e6a92c"}
            thumbnail-time={frontmatter.thumbnailTime ?? 2}
            loop={frontmatter.loop ? "true" : undefined}
            autoplay={frontmatter.autoplay || undefined}
          />
        ) : frontmatter.heroImage ? (
          <figure class="portfolio-figure fadeup-st">
            <img src={frontmatter.heroImage} alt={title} loading="lazy" />
          </figure>
        ) : null
      }

      <section id="about" class="section">
        <Spacer size="large" />
        <div class="grid-columns-2">
          <p class="heading-sub fadeup-st">About</p>
          <div class="prose">
            <article class="case-content text fadeup-st">
              <slot />
            </article>
          </div>
        </div>
      </section>

      <section class="project-images fadeup-st">
        <figure class="portfolio-figure">
          <img src={frontmatter.secondaryImage} alt={title} loading="lazy" />
        </figure>
      </section>
      <Spacer size="xl" />
      <ContactSection />
    </PageWrapper>
  </main>
</Layout>

<style>
  mux-player {
    --controls: none;
  }
</style>
