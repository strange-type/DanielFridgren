---
import "../global.css";
import Footer from "../components/layouts/Footer.astro";
import Navbar from "../components/layouts/navbar/Navbar.astro";
import HyphenopolyClient from "../components/HyphenopolyClient.astro";

export interface Props {
  title?: string;
  desc?: string;
  type?: string;
  coverImage?: string;
}

const { title, desc, type, coverImage } = Astro.props;

// const canonicalURL = new URL(Astro.request.url, Astro.site).toString();

// Generate OG image URL
// const currentPath = Astro.url.pathname;
// const contentId = currentPath.split("/").filter(Boolean).join("/");

// Use localhost URL in development, production URL otherwise
const baseUrl = import.meta.env.DEV ? "http://localhost:4321" : Astro.site;

// Construct OG image URL - now just using the content ID directly
// const ogImageURL = type
// 	? new URL(`/og/${contentId}.png`, baseUrl)
//	: new URL(`/og.png`, baseUrl);

// Only add search params for non-content pages (like the homepage)
//if (!type) {
//	if (title) ogImageURL.searchParams.set("title", title);
//	if (desc) ogImageURL.searchParams.set("description", desc);
//	if (coverImage) ogImageURL.searchParams.set("coverImage", coverImage);
//}

// Google Analytics type declarations
// declare global {
//	interface Window {
//		dataLayer: any[];
//		gtag: (...args: any[]) => void;
//	}
//}
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="robots" content="index, follow" />
    <meta name="googlebot" content="index, follow" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.png" />
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- Site-wide defaults; page-level SEO comes from seo.astro -->
    <meta property="og:image" content="/images/og-image.png" />
    <meta property="og:type" content="website" />

    <meta name="author" content="Daniel Fridgren" />

    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/images/favicon/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/favicon/favicon-32x32.png"
    />
    <link rel="manifest" href="/manifest.json" />
    <link rel="me" href="https://linkedin.com/in/fridgren" />

    <!-- Privacy-friendly analytics by Plausible -->
    <script
      defer
      data-domain="fridgren.se"
      src="https://plausible.io/js/script.js"></script>
  </head>
  <body>
    <HyphenopolyClient />
    <Navbar />
    <main>
      <slot />
      <Footer />
    </main>

    <style is:global>
      /* Improve Page speed */
      /* https://css-tricks.com/almanac/properties/c/content-visibility/ */
      img {
        content-visibility: auto;
      }
    </style>
  </body>
</html>
